{"version":3,"sources":["webpack:///./src/views/edit/edit.vue?7df2","webpack:///./src/views/edit/edit.vue","webpack:///./src/views/edit/edit.vue?2195","webpack:///./src/views/edit/edit.vue?0bd8","webpack:///./src/views/edit/edit.vue?131d"],"names":["render","_vm","this","_h","$createElement","_c","_self","directives","name","rawName","value","expression","modifiers","staticClass","attrs","_v","ref","form","rules","model","callback","$$v","$set","on","$event","addOption","questionType","SINGLE_CHOICE","MULTIPLE_CHOICE","TEXT_QUESTION","topic","onDelQuestion","onAddOption","onDelOption","datePickerOptions","submitNaire","NaireStatus","UNPUBLISHED","PUBLISHED","staticRenderFns","title","intro","deadline","status","options","loading","required","message","trigger","disabledDate","time","getTime","add","valueOf","index","tempData","content","isAddition","image","desc","push","opIndex","length","$message","warning","splice","type","radioQues","question","description","isRequired","selectContent","setting","last","additional","checkboxQues","selectMultipleContent","textareaQues","$refs","validate","valid","async","params","naire","Date","res","success","$router","error","msg","n_id","$route","id","data","Number","fetchData","components","QuestionList","component"],"mappings":"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","file":"js/chunk-ea2c5250.6e544eb0.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{directives:[{name:\"loading\",rawName:\"v-loading.fullscreen.lock\",value:(_vm.loading),expression:\"loading\",modifiers:{\"fullscreen\":true,\"lock\":true}}],staticClass:\"create\"},[_c('el-alert',{staticClass:\"mb-20\",attrs:{\"type\":\"error\"}},[_vm._v(\"编辑问卷会清空已有的统计数据，请确保问卷在未发布的情况下进行修改。\")]),_c('el-form',{ref:\"form\",attrs:{\"model\":_vm.form,\"rules\":_vm.rules,\"label-position\":\"right\",\"label-width\":\"100px\"}},[_c('el-form-item',{attrs:{\"label\":\"问卷名称\",\"prop\":\"title\"}},[_c('el-input',{model:{value:(_vm.form.title),callback:function ($$v) {_vm.$set(_vm.form, \"title\", $$v)},expression:\"form.title\"}})],1),_c('el-form-item',{attrs:{\"label\":\"问卷介绍\",\"prop\":\"intro\"}},[_c('el-input',{attrs:{\"type\":\"textarea\",\"rows\":\"5\"},model:{value:(_vm.form.intro),callback:function ($$v) {_vm.$set(_vm.form, \"intro\", $$v)},expression:\"form.intro\"}})],1),_c('div',{staticClass:\"add-option\"},[_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){return _vm.addOption(_vm.questionType.SINGLE_CHOICE)}}},[_vm._v(\"单选题\")]),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){return _vm.addOption(_vm.questionType.MULTIPLE_CHOICE)}}},[_vm._v(\"多选题\")]),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){return _vm.addOption(_vm.questionType.TEXT_QUESTION)}}},[_vm._v(\"文本题\")])],1),_c('question-list',{attrs:{\"question-list\":_vm.form.topic},on:{\"delQuestion\":_vm.onDelQuestion,\"addOption\":_vm.onAddOption,\"delOption\":_vm.onDelOption}}),_c('el-form-item',{attrs:{\"label\":\"截止时间\",\"prop\":\"deadline\"}},[_c('el-date-picker',{attrs:{\"type\":\"datetime\",\"picker-options\":_vm.datePickerOptions,\"placeholder\":\"选择日期时间\"},model:{value:(_vm.form.deadline),callback:function ($$v) {_vm.$set(_vm.form, \"deadline\", $$v)},expression:\"form.deadline\"}})],1),_c('el-form-item',[_c('el-button',{attrs:{\"type\":\"default\"},on:{\"click\":function($event){return _vm.submitNaire(_vm.NaireStatus.UNPUBLISHED)}}},[_vm._v(\"保存问卷\")]),_c('el-button',{attrs:{\"type\":\"success\"},on:{\"click\":function($event){return _vm.submitNaire(_vm.NaireStatus.PUBLISHED)}}},[_vm._v(\"发布问卷\")])],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport { Component, Vue } from 'vue-property-decorator'\r\nimport dayjs from 'dayjs'\r\nimport { Form as ElForm } from 'element-ui'\r\n\r\nimport * as NaireAction from '@/api/naire'\r\n\r\nimport { questionType, questionTypeText } from '@/config/enum/questionType'\r\nimport { NaireStatus } from '@/config/enum/naireStatus'\r\n\r\nimport QuestionList from '@/components/Question/QuestionList.vue'\r\n\r\n@Component({\r\n  components: {\r\n    QuestionList\r\n  }\r\n})\r\nexport default class NavBar extends Vue {\r\n  private questionType = questionType\r\n  private NaireStatus = NaireStatus\r\n  private form:Questionnaire.INaire = {\r\n    title: '',\r\n    intro: '',\r\n    deadline: '',\r\n    status: 0,\r\n    options: '',\r\n    topic: []\r\n  }\r\n  private loading: boolean = false\r\n  private rules = {\r\n    title: [\r\n      { required: true, message: '请输入问卷标题', trigger: 'blur' }\r\n    ],\r\n    deadline: [\r\n      { required: true, message: '请选择截止时间', trigger: 'blur' }\r\n    ]\r\n  }\r\n\r\n  private datePickerOptions = {\r\n    disabledDate (time: Date) {\r\n      return time.getTime() < dayjs().add(-1, 'day').valueOf()\r\n    }\r\n  }\r\n\r\n  private onAddOption ({ index }: { index: number }) {\r\n    const tempData = {\r\n      content: '选项',\r\n      isAddition: false,\r\n      image: '', // 选项图片\r\n      desc: ''\r\n    }\r\n    this.form.topic[index].options!.push({ ...tempData })\r\n  }\r\n\r\n  private onDelOption ({ index, opIndex }: { index: number, opIndex: number }) {\r\n    if (this.form.topic[index].options!.length < 2) {\r\n      return this.$message.warning('已经是最后一个选项，无法删除。')\r\n    }\r\n    this.form.topic[index].options!.splice(opIndex, 1)\r\n  }\r\n\r\n  private onDelQuestion ({ index }: { index: number }) {\r\n    this.form.topic.splice(index, 1)\r\n  }\r\n\r\n  addOption (type: questionTypeText) {\r\n    switch (type) {\r\n      case questionType.SINGLE_CHOICE:\r\n        const radioQues = {\r\n          question: '单选题目',\r\n          options: [\r\n            {\r\n              content: '选项',\r\n              isAddition: false,\r\n              image: '',\r\n              desc: ''\r\n            }\r\n          ],\r\n          description: '',\r\n          type: '单选',\r\n          isRequired: true,\r\n          selectContent: '',\r\n          setting: {\r\n            last: 1\r\n          },\r\n          additional: ''\r\n        }\r\n        this.form.topic.push(radioQues)\r\n        break\r\n      case questionType.MULTIPLE_CHOICE:\r\n        const checkboxQues = {\r\n          question: '多选题目',\r\n          options: [\r\n            {\r\n              content: '选项',\r\n              isAddition: false,\r\n              image: '',\r\n              desc: ''\r\n            }\r\n          ],\r\n          description: '',\r\n          type: '多选',\r\n          isRequired: true,\r\n          setting: {\r\n            last: 1 // 最少选择几项\r\n          },\r\n          selectMultipleContent: []\r\n        }\r\n        this.form.topic.push(checkboxQues)\r\n        break\r\n      case questionType.TEXT_QUESTION:\r\n        const textareaQues = {\r\n          question: '文本题目',\r\n          description: '',\r\n          type: '文本',\r\n          isRequired: true,\r\n          setting: {},\r\n          selectContent: ''\r\n        }\r\n        this.form.topic.push(textareaQues)\r\n        break\r\n    }\r\n  }\r\n\r\n  submitNaire (type: NaireStatus) {\r\n    const form = this.$refs.form as ElForm\r\n    form.validate(async (valid) => {\r\n      if (!valid) return\r\n      if (this.form.topic.length === 0) {\r\n        return this.$message.warning('请至少添加一道题目。')\r\n      }\r\n      const params = {\r\n        naire: {\r\n          ...this.form,\r\n          deadline: new Date(this.form.deadline).getTime()\r\n        },\r\n        status: 'update'\r\n      }\r\n      this.loading = true\r\n      const res = await NaireAction.create(params)\r\n      this.loading = false\r\n      if (res.success) {\r\n        this.$message.success('修改问卷成功！')\r\n        await this.$router.push('/list')\r\n      } else {\r\n        this.$message.error(res.msg)\r\n      }\r\n    })\r\n  }\r\n\r\n  async fetchData () {\r\n    this.loading = true\r\n    const res = await NaireAction.detail({\r\n      n_id: this.$route.params.id,\r\n      type: 'normal'\r\n    })\r\n    this.loading = false\r\n    if (res.success) {\r\n      this.form = {\r\n        ...res.data,\r\n        deadline: new Date(Number(res.data.deadline))\r\n      }\r\n    }\r\n  }\r\n\r\n  mounted () {\r\n    this.fetchData()\r\n  }\r\n}\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--14-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./edit.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--14-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./edit.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./edit.vue?vue&type=template&id=88f8c3c2&scoped=true&\"\nimport script from \"./edit.vue?vue&type=script&lang=ts&\"\nexport * from \"./edit.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./edit.vue?vue&type=style&index=0&id=88f8c3c2&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"88f8c3c2\",\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./edit.vue?vue&type=style&index=0&id=88f8c3c2&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./edit.vue?vue&type=style&index=0&id=88f8c3c2&lang=scss&scoped=true&\""],"sourceRoot":""}