(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c809a6c2"],{"96bc":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.loading,expression:"loading",modifiers:{fullscreen:!0,lock:!0}}],staticClass:"create"},[n("el-alert",{staticClass:"mb-20",attrs:{type:"error"}},[e._v("编辑问卷会清空已有的统计数据，请确保问卷在未发布的情况下进行修改。")]),n("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-position":"right","label-width":"100px"}},[n("el-form-item",{attrs:{label:"问卷名称",prop:"title"}},[n("el-input",{model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),n("el-form-item",{attrs:{label:"问卷介绍",prop:"intro"}},[n("el-input",{attrs:{type:"textarea",rows:"5"},model:{value:e.form.intro,callback:function(t){e.$set(e.form,"intro",t)},expression:"form.intro"}})],1),n("div",{staticClass:"add-option"},[n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.addOption(e.questionType.SINGLE_CHOICE)}}},[e._v("单选题")]),n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.addOption(e.questionType.MULTIPLE_CHOICE)}}},[e._v("多选题")]),n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.addOption(e.questionType.TEXT_QUESTION)}}},[e._v("文本题")])],1),n("question-list",{attrs:{"question-list":e.form.topic},on:{delQuestion:e.onDelQuestion,addOption:e.onAddOption,delOption:e.onDelOption}}),n("el-form-item",{attrs:{label:"截止时间",prop:"deadline"}},[n("el-date-picker",{attrs:{type:"datetime","picker-options":e.datePickerOptions,placeholder:"选择日期时间"},model:{value:e.form.deadline,callback:function(t){e.$set(e.form,"deadline",t)},expression:"form.deadline"}})],1),n("el-form-item",[n("el-button",{attrs:{type:"default"},on:{click:function(t){return e.submitNaire(e.NaireStatus.UNPUBLISHED)}}},[e._v("保存问卷")]),n("el-button",{attrs:{type:"success"},on:{click:function(t){return e.submitNaire(e.NaireStatus.PUBLISHED)}}},[e._v("发布问卷")])],1)],1)],1)},i=[],a=(n("a4d3"),n("4de4"),n("a434"),n("a9e3"),n("e439"),n("dbb4"),n("b64b"),n("d3b7"),n("159b"),n("96cf"),n("ade3")),o=n("d4ec"),s=n("bee2"),c=n("99de"),u=n("7e84"),l=n("262e"),p=n("9ab4"),d=n("60a3"),f=n("5a0c"),m=n.n(f),b=n("3ec7"),g=n("5d15"),v=n("f6b1"),O=n("9bcc");function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){Object(a["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var k=function(e){function t(){var e;return Object(o["a"])(this,t),e=Object(c["a"])(this,Object(u["a"])(t).apply(this,arguments)),e.questionType=g["a"],e.NaireStatus=v["a"],e.form={title:"",intro:"",deadline:"",status:0,options:"",topic:[]},e.loading=!1,e.rules={title:[{required:!0,message:"请输入问卷标题",trigger:"blur"}],deadline:[{required:!0,message:"请选择截止时间",trigger:"blur"}]},e.datePickerOptions={disabledDate:function(e){return e.getTime()<m()().add(-1,"day").valueOf()}},e}return Object(l["a"])(t,e),Object(s["a"])(t,[{key:"onAddOption",value:function(e){var t=e.index,n={content:"选项",isAddition:!1,image:"",desc:""};this.form.topic[t].options.push(y({},n))}},{key:"onDelOption",value:function(e){var t=e.index,n=e.opIndex;if(this.form.topic[t].options.length<2)return this.$message.warning("已经是最后一个选项，无法删除。");this.form.topic[t].options.splice(n,1)}},{key:"onDelQuestion",value:function(e){var t=e.index;this.form.topic.splice(t,1)}},{key:"addOption",value:function(e){switch(e){case g["a"].SINGLE_CHOICE:var t={question:"单选题目",options:[{content:"选项",isAddition:!1,image:"",desc:""}],description:"",type:"单选",isRequired:!0,selectContent:"",setting:{last:1},additional:""};this.form.topic.push(t);break;case g["a"].MULTIPLE_CHOICE:var n={question:"多选题目",options:[{content:"选项",isAddition:!1,image:"",desc:""}],description:"",type:"多选",isRequired:!0,setting:{last:1},selectMultipleContent:[]};this.form.topic.push(n);break;case g["a"].TEXT_QUESTION:var r={question:"文本题目",description:"",type:"文本",isRequired:!0,setting:{},selectContent:""};this.form.topic.push(r);break}}},{key:"submitNaire",value:function(e){var t=this,n=this.$refs.form;n.validate((function(e){var n,r;return regeneratorRuntime.async((function(i){while(1)switch(i.prev=i.next){case 0:if(e){i.next=2;break}return i.abrupt("return");case 2:if(0!==t.form.topic.length){i.next=4;break}return i.abrupt("return",t.$message.warning("请至少添加一道题目。"));case 4:return n={naire:y({},t.form,{deadline:new Date(t.form.deadline).getTime()}),status:"update"},t.loading=!0,i.next=8,regeneratorRuntime.awrap(b["c"](n));case 8:if(r=i.sent,t.loading=!1,!r.success){i.next=16;break}return t.$message.success("修改问卷成功！"),i.next=14,regeneratorRuntime.awrap(t.$router.push("/list"));case 14:i.next=17;break;case 16:t.$message.error(r.msg);case 17:case"end":return i.stop()}}))}))}},{key:"fetchData",value:function(){var e;return regeneratorRuntime.async((function(t){while(1)switch(t.prev=t.next){case 0:return this.loading=!0,t.next=3,regeneratorRuntime.awrap(b["f"]({n_id:this.$route.params.id,type:"normal"}));case 3:e=t.sent,this.loading=!1,e.success&&(this.form=y({},e.data,{deadline:new Date(Number(e.data.deadline))}));case 6:case"end":return t.stop()}}),null,this)}},{key:"mounted",value:function(){this.fetchData()}}]),t}(d["c"]);k=p["a"]([Object(d["a"])({components:{QuestionList:O["a"]}})],k);var w=k,x=w,j=(n("f890"),n("2877")),E=Object(j["a"])(x,r,i,!1,null,"f93f6fc4",null);t["default"]=E.exports},b0e4:function(e,t,n){},f890:function(e,t,n){"use strict";var r=n("b0e4"),i=n.n(r);i.a}}]);
//# sourceMappingURL=chunk-c809a6c2.1b51e070.js.map